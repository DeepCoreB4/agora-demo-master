(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["restfulApi"],{"9fc7":function(e,t,n){"use strict";n.r(t);var a=n("1da1"),s=n("d4ec"),r=n("bee2"),i=n("262e"),o=n("2caf"),l=(n("d81d"),n("96cf"),n("9ab4")),c=n("a026"),d=n("2fe1"),u=n("00d6"),h=function(e){Object(i["a"])(n,e);var t=Object(o["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.restfulKeys=[],e.loading=!1,e.addingState=!1,e.disableAdd=!1,e.showDeleteConfirmation=!1,e.showAddConfirmation=!1,e.showDownloadConfirmation=!1,e.deleteKey="",e.downloadKey="",e.downloadSecretHref="",e.keyLimit=10,e.IconDelete=u,e}return Object(r["a"])(n,[{key:"created",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.getkeyLimit();case 3:return e.next=5,this.getkeys();case 5:this.loading=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addKey",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,!(this.restfulKeys.length>=this.keyLimit)){e.next=4;break}return this.$message.error(this.$t("RestfulKeyOutOfLimit")),e.abrupt("return");case 4:return e.next=6,this.createNewKey();case 6:this.loading=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDownloadSecret",value:function(e){this.showDownloadConfirmation=!0,this.downloadKey=e}},{key:"deleteRow",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.addingState?this.$message.warning(this.$t("AddRestfulApiKeyIsNotDone")):(this.showDeleteConfirmation=!0,this.deleteKey=n.key);case 1:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"confirmDelete",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,this.showDeleteConfirmation=!1,e.prev=2,e.next=5,this.$http.delete("/api/v2/restful-api/keys/".concat(this.deleteKey));case 5:this.$message({message:this.$t("SuccessDeleteRestfulKey"),type:"success"}),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](2),6008===e.t0.response.data.code&&this.$message.error(this.$t("ParameterError")),15008===e.t0.response.data.code?this.$message.error(this.$t("KeepAtLeastOneKey")):this.$message.error(this.$t("FailedDeleteRestfulKey"));case 12:return e.next=14,this.getkeys();case 14:this.restfulKeys=e.sent,this.loading=!1;case 16:case"end":return e.stop()}}),e,this,[[2,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancelDelete",value:function(){this.showDeleteConfirmation=!1}},{key:"confirmDownload",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("/api/v2/restful-api/keys/download/".concat(this.downloadKey));case 3:t=e.sent,this.showDownloadConfirmation=!1,this.downloadSecretHref="data:text/plain;charset=utf-8,".concat(encodeURIComponent(this.$t("ConfirmDownloadApiKey")+"\r\nkey："+t.data.key+"\r\nsecret："+t.data.secret)),this.restfulKeys.map((function(e){return e.key===t.data.key&&(e.downloaded=1),e})),this.$nextTick((function(){document.getElementById("downloadSecret").click(),n.downloadSecretHref=""})),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),6008===e.t0.response.data.code?this.$message.error(this.$t("ParameterError")):15007===e.t0.response.data.code?this.$message.error(this.$t("AlreadyDownloaded")):this.$message.error(this.$t("FailedDownloadRestfulKey"));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancelDownload",value:function(){this.showDownloadConfirmation=!1}},{key:"getkeys",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("/api/v2/restful-api/keys/own");case 3:return t=e.sent,n=t.data,a=n.map((function(e){return Object.assign({},e,{editing:!1})})),this.restfulKeys=a,this.disableAdd=this.restfulKeys.length>=this.keyLimit,e.abrupt("return",a);case 11:e.prev=11,e.t0=e["catch"](0),this.$message.error(this.$t("FailedGetRestfulKey"));case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getkeyLimit",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("/api/v2/restful-api/keys-limit");case 3:t=e.sent,this.keyLimit=t.data.limit,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.$message.error(this.$t("FailedGetRestfulKeyLimit"));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"createNewKey",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.post("/api/v2/restful-api/keys");case 3:if(t=e.sent,!t.data){e.next=9;break}return this.$message({message:this.$t("SuccessCreateRestfulKey"),type:"success"}),e.next=8,this.getkeys();case 8:this.addingState=!1;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),6008===e.t0.response.data.code?this.$message.error(this.$t("ParameterError")):15005===e.t0.response.data.code?this.$message.error(this.$t("RestfulKeyOutOfLimit")):this.$message.error(this.$t("GerneralError"));case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()}]),n}(c["default"]);h=Object(l["a"])([Object(d["b"])({template:'\n    <div v-loading="loading">\n      <div class="page">\n        <div class="module-title">{{ $t(\'RestfulAPITitle\') }}</div>\n        <div class="module-title-tip">\n          <div class="d-flex flex-column">\n            <label> {{ $t(\'RestfulApiDesc1\') }} </label>\n            <label>\n              {{ $t(\'RestfulApiDesc2\') }} <a :href=\'$t("RestfulApi")\' target=":blank"> {{ $t(\'RestfulApiDoc\') }} </a>\n              {{ $t(\'FullStop\') }}\n            </label>\n            <label> {{ $t(\'RestfulApiDesc3\') }} </label>\n          </div>\n        </div>\n        <div class="mb-10">\n          <console-button style="font-size: 14px" type="primary" :disabled="addingState || disableAdd" @click="addKey">\n            {{ $t(\'AddSecret\') }}\n          </console-button>\n        </div>\n        <div class="card">\n          <el-table\n            :data="restfulKeys"\n            stripe\n            cell-class-name="text-truncate"\n            :empty-text=\'$t("RestfulApiEmptyText")\'\n            :row-style=\'{ height: "50px" }\'\n          >\n            <el-table-column\n              prop="key"\n              :label=\'$t("CustomerID")\'\n              label-class-name="table-header"\n              class-name="table-content"\n            >\n              <template slot-scope="scope">\n                {{ scope.row.key }}\n              </template>\n            </el-table-column>\n            <el-table-column\n              prop="secretPassword"\n              :label=\'$t("CustomerCertificate")\'\n              label-class-name="table-header"\n              class-name="table-content"\n              align="center"\n            >\n              <template slot-scope="scope">\n                <div v-if="scope.row.editing">****************</div>\n                <div v-else-if="scope.row.downloaded">\n                  {{ $t(\'KeyIsDownloadedDesc1\') }}\n                  <a :href=\'$t("KeyIsDownloadedHref")\' target="_blank">{{ $t(\'KeyIsDownloadedDesc2\') }}</a>\n                  {{ $t(\'KeyIsDownloadedDesc3\') }}\n                </div>\n                <div v-else>\n                  <el-button type="text" class="button button-mid" @click="onDownloadSecret(scope.row.key)">\n                    {{ $t(\'Download\') }}\n                  </el-button>\n                </div>\n              </template>\n            </el-table-column>\n            <el-table-column\n              prop="action"\n              :label=\'$t("Action")\'\n              width="300px"\n              label-class-name="table-header"\n              class-name="table-content"\n              align="right"\n            >\n              <template slot-scope="scope">\n                <div>\n                  <img class="table-action-img" @click="deleteRow(scope.$index, scope.row)" :src="IconDelete" />\n                </div>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n\n        <el-dialog\n          :title=\'$t("RemoveRestfulKey")\'\n          :visible.sync="showDeleteConfirmation"\n          width="360px"\n          :show-close="false"\n        >\n          <div class="d-flex flex-column">\n            <div class="mb-20">{{ $t(\'RemoveRestfulKeyConfirm\') }}</div>\n            <div class="ml-auto text-right">\n              <console-button @click="cancelDelete">\n                {{ $t(\'Cancel\') }}\n              </console-button>\n              <console-button type="danger" @click="confirmDelete">\n                {{ $t(\'Delete\') }}\n              </console-button>\n            </div>\n          </div>\n        </el-dialog>\n\n        <el-dialog\n          :title=\'$t("DownloadKeyAndSecret")\'\n          :visible.sync="showDownloadConfirmation"\n          width="360px"\n          :show-close="false"\n        >\n          <div class="d-flex flex-column">\n            <div class="mb-20">{{ $t(\'ConfirmDownloadApiKey\') }}</div>\n            <div class="ml-auto text-right">\n              <console-button @click="cancelDownload">\n                {{ $t(\'Cancel\') }}\n              </console-button>\n              <console-button type="primary" @click="confirmDownload">\n                {{ $t(\'Download\') }}\n              </console-button>\n            </div>\n          </div>\n        </el-dialog>\n\n        <a id="downloadSecret" :href="downloadSecretHref" download="key_and_secret.txt"></a>\n      </div>\n    </div>\n  '})],h),t["default"]=h}}]);